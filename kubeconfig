What is a Kubeconfig File?
###########################

=> A Kubeconfig file is a YAML configuration file that tells kubectl how to reach and authenticate to one or more Kubernetes clusters. 
It contains configuration information (cluster address, authentication information, and the default namespace ) required to access Kubernetes clusters.
It is used by the kubectl command-line tool to determine which cluster to communicate with, how to authenticate, and which namespace to operate in by default.

=> When a kubectl command is executed, it reads this file to connect to the Kubernetes API server and perform the requested operation.

=> By default, kubectl searches for the kubeconfig file in these locations:  
    Linux / macOS: ~/.kube/config
    Windows: %USERPROFILE%\.kube\config

=> If needed, a different kubeconfig file can be used by passing the --kubeconfig option OR by setting the KUBECONFIG environment variable.
   This is especially useful when working with multiple Kubernetes clusters.


1. Using the KUBECONFIG environment variable
KUBECONFIG=/my/kubeconfig kubectl get pods

2. Using the --kubeconfig flag
kubectl get pods --kubeconfig /my/kubeconfig

Structure of the Kubeconfig File
####################################

The kubeconfig file is divided into several key sections, each serving a specific purpose:

clusters: Defines the clusters that kubectl can connect to.

users: Defines the users (or service accounts) that can authenticate against the clusters.

contexts: Binds a cluster, a user, and a namespace into a single configuration that kubectl can switch between.

a. Clusters
=============
    The clusters section contains the connection details for each Kubernetes cluster.  Each cluster is identified by a unique name, and its configuration includes the server field, which is the URL of the cluster's API server. The certificate-authority field specifies the path to the CA certificate used to verify the API server's certificate.

    This section tells kubectl which Kubernetes clusters exist and how to reach them. Each entry has:
    
    #  name: This is the human-friendly and  A unique identifier for the cluster. You’ll use this to reference the cluster later. 
    
    #  certificate-authority: This is the path to the CA (certificate authority) file that validates the Kubernetes API server's identity. Without this, you might be chatting with a stranger (not good!).
    
    #  server: The URL for the cluster’s API server.
    
    | Field                        | Type   | Required | Description                          |
    | ---------------------------- | ------ | -------- | ------------------------------------ |
    | `server`                     | string | Yes      | API server URL                       |
    | `certificate-authority`      | string | No       | Path to CA file for TLS verification |
    | `certificate-authority-data` | string | No       | Base64-encoded CA data               |
    | `insecure-skip-tls-verify`   | bool   | No       | Skip TLS verification (insecure)     |
    | `extensions`                 | list   | No       | Optional metadata for the cluster    |
    
    => certificate-authority vs certificate-authority-data
    =======================================================
    
     #  certificate-authority (File-based CA):
    ===========================================
    
        The certificate-authority field specifies the path to the file containing the Certificate Authority (CA) certificate. 
        This CA certificate is used by kubectl to verify the authenticity of the Kubernetes API server it is communicating with.
    
        Purpose: It ensures that kubectl is talking to the real Kubernetes API server and not an impersonator.
    
        Format: This field holds a reference to a file path that contains the CA certificate in PEM format.
    
        clusters:
        - cluster:
            certificate-authority: /etc/kubernetes/pki/ca-prod.crt
            server: https://prod-cluster-api.example.com:6443
          name: prod-cluster
    
        In this example, the kubectl client will read the CA certificate from /etc/kubernetes/pki/ca-prod.crt to verify the server's identity.
    
    #  certificate-authority-data (Embedded Base64-encoded CA):
    ===========================================================
    
    The certificate-authority-data field is used to embed the actual CA certificate directly in the kubeconfig file as a Base64-encoded string. 
    This eliminates the need for a separate file on disk. 
    It’s particularly useful when you want to distribute a kubeconfig file that contains everything necessary to connect to the Kubernetes API, without needing extra files.
    
    Purpose: It allows the CA certificate to be included directly in the kubeconfig file, avoiding the need to reference an external file.
    
    Format: The CA certificate is embedded as a Base64-encoded string.
    
    clusters:
    - cluster:
        certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JS...
        server: https://staging-cluster-api.example.com:6443
      name: staging-cluster
    
    In this example, the CA certificate is directly included in the kubeconfig as a Base64 string, ensuring the certificate is bundled with the config.
    
    Key Differences:
    =================
    
    File-based (certificate-authority): Refers to a certificate stored in a file on the local filesystem.
    
    Embedded (certificate-authority-data): Contains the certificate inline as a Base64 string within the kubeconfig itself.



EXAMPLE:
########
apiVersion: v1
kind: Config
clusters:
- name: cluster-1
  cluster:
    server: https://cluster-1-api-server:6443
    certificate-authority: /path/to/ca.crt
- name: cluster-2
  cluster:
    server: https://cluster-2-api-server:6443
    certificate-authority: /path/to/ca.crt
users:
- name: user-1
  user:
    client-certificate: /path/to/client.crt
    client-key: /path/to/client.key
- name: user-2
  user:
    token: abcdef123456
contexts:
- name: context-1
  context:
    cluster: cluster-1
    user: user-1
    namespace: default
- name: context-2
  context:
    cluster: cluster-2
    user: user-2
    namespace: development
current-context: context-1





















current-context: Defines which context is currently active, determining which cluster, user, and namespace kubectl will use.
